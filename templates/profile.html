<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ user.username }} ‚Äî NFL Trivia</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Barlow+Condensed:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:#060a0f; --surface:#0d1520; --card:#111c2a; --border:#1e3048;
    --gold:#f5c518; --text:#e8edf2; --muted:#5a7289; --green:#22c55e; --red:#e53e3e;
  }
  *, *::before, *::after { box-sizing:border-box; margin:0; padding:0; }
  body { background:var(--bg); color:var(--text); font-family:'Barlow Condensed',sans-serif; min-height:100vh; }
  body::before {
    content:''; position:fixed; inset:0;
    background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.08) 2px,rgba(0,0,0,.08) 4px);
    pointer-events:none; z-index:9999;
  }
  .wrapper { max-width:800px; margin:0 auto; padding:0 16px 60px; position:relative; z-index:1; }
  header {
    display:flex; align-items:center; justify-content:space-between;
    padding:20px 0 16px; border-bottom:2px solid var(--gold); margin-bottom:32px;
  }
  .logo { font-family:'Bebas Neue',sans-serif; font-size:2.4rem; letter-spacing:3px; color:var(--gold); line-height:1; }
  .logo span { color:var(--text); font-size:1rem; display:block; letter-spacing:6px; }
  nav a { color:var(--muted); text-decoration:none; font-size:.85rem; letter-spacing:1px; text-transform:uppercase; margin-left:20px; }
  nav a:hover { color:var(--gold); }

  .profile-hero {
    display:flex; align-items:center; gap:20px;
    background:var(--card); border:1px solid var(--border);
    border-top:3px solid var(--gold); border-radius:8px;
    padding:24px 28px; margin-bottom:28px;
  }
  .avatar {
    width:60px; height:60px; border-radius:50%;
    background:var(--gold); display:flex; align-items:center; justify-content:center;
    font-family:'Bebas Neue',sans-serif; font-size:1.8rem; color:#000; flex-shrink:0;
  }
  .username { font-family:'Bebas Neue',sans-serif; font-size:2rem; letter-spacing:2px; color:var(--gold); }
  .member-since { font-size:.8rem; letter-spacing:1px; color:var(--muted); text-transform:uppercase; margin-top:2px; }

  .section-title {
    font-family:'Bebas Neue',sans-serif; font-size:1.3rem; letter-spacing:3px; color:var(--muted);
    text-transform:uppercase; margin-bottom:12px; margin-top:28px;
    border-bottom:1px solid var(--border); padding-bottom:6px;
  }

  .stats-row { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-bottom:8px; }
  .stat-box {
    background:var(--card); border:1px solid var(--border); border-radius:6px;
    padding:16px 12px; text-align:center;
  }
  .stat-val { font-family:'Bebas Neue',sans-serif; font-size:2.2rem; color:var(--gold); line-height:1; }
  .stat-label { font-size:.65rem; letter-spacing:2px; text-transform:uppercase; color:var(--muted); margin-top:4px; }

  .cat-row {
    background:var(--card); border:1px solid var(--border); border-radius:6px;
    padding:12px 16px; margin-bottom:8px;
    display:grid; grid-template-columns:120px 1fr 60px; align-items:center; gap:12px;
  }
  .cat-name { font-size:.95rem; font-weight:600; }
  .cat-bar-wrap { background:var(--border); border-radius:2px; height:8px; overflow:hidden; }
  .cat-bar { height:100%; border-radius:2px; background:var(--gold); }
  .cat-pct { font-family:'Bebas Neue',sans-serif; font-size:1.2rem; color:var(--gold); text-align:right; }

  .session-row {
    background:var(--card); border:1px solid var(--border); border-radius:6px;
    padding:12px 18px; margin-bottom:8px;
    display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;
  }
  .session-date { font-size:.75rem; color:var(--muted); letter-spacing:1px; text-transform:uppercase; }
  .session-mu { font-family:'Bebas Neue',sans-serif; font-size:1.4rem; color:var(--gold); }
  .tag {
    font-size:.7rem; letter-spacing:1px; text-transform:uppercase;
    padding:2px 8px; border-radius:3px;
    background:rgba(59,130,246,.1); color:#60a5fa; border:1px solid rgba(59,130,246,.2);
  }
  .empty { text-align:center; padding:40px; color:var(--muted); }

  @media(max-width:540px) {
    .stats-row { grid-template-columns:1fr 1fr; }
    .cat-row { grid-template-columns:100px 1fr 50px; }
  }
</style>
</head>
<body>
<div class="wrapper">
  <header>
    <div class="logo">NFL Trivia<span>Adaptive Edition</span></div>
    <nav>
      <a href="/">‚Üê Play</a>
      <a href="/leaderboard">üèÜ Leaderboard</a>
      <a href="/logout">Log out</a>
    </nav>
  </header>

  <div class="profile-hero">
    <div class="avatar">{{ user.username[0].upper() }}</div>
    <div>
      <div class="username">{{ user.username }}</div>
      <div class="member-since">Member since {{ user.created_at.strftime('%B %Y') }}</div>
    </div>
  </div>

  {% if sessions %}
  {% set best_mu = sessions | map(attribute='final_mu') | max %}
  {% set total_games = sessions | length %}
  {% set avg_acc = (sessions | map(attribute='accuracy') | sum) / total_games * 100 %}
  {% set best_streak = sessions | map(attribute='best_streak') | max %}

  <div class="section-title">Career Stats</div>
  <div class="stats-row">
    <div class="stat-box"><div class="stat-val">{{ "%.2f"|format(best_mu) }}</div><div class="stat-label">Best Œº</div></div>
    <div class="stat-box"><div class="stat-val">{{ total_games }}</div><div class="stat-label">Games</div></div>
    <div class="stat-box"><div class="stat-val">{{ "%.0f"|format(avg_acc) }}%</div><div class="stat-label">Avg Acc</div></div>
    <div class="stat-box"><div class="stat-val">{{ best_streak }}</div><div class="stat-label">Best Streak</div></div>
  </div>
  {% endif %}

  {% if cat_data %}
  <div class="section-title">Accuracy by Category</div>
  {% for c in cat_data %}
  <div class="cat-row">
    <div class="cat-name">{{ c.category }}</div>
    <div class="cat-bar-wrap"><div class="cat-bar" style="width:{{ c.pct }}%"></div></div>
    <div class="cat-pct">{{ c.pct }}%</div>
  </div>
  {% endfor %}
  {% endif %}

  <div class="section-title">Session History</div>
  {% if sessions %}
    {% for s in sessions %}
    <div class="session-row">
      <div>
        <div class="session-date">{{ s.played_at.strftime('%b %d, %Y ¬∑ %I:%M %p') }}</div>
        <div style="margin-top:3px; font-size:.9rem; color:var(--muted)">
          {{ s.rounds }} questions
          {% if s.timed %} ¬∑ ‚è± Timed{% endif %}
          {% if s.multiplayer %} ¬∑ üë• Multiplayer{% endif %}
        </div>
      </div>
      <div style="display:flex; align-items:center; gap:16px;">
        <div style="text-align:center">
          <div class="session-mu">{{ "%.2f"|format(s.final_mu) }}</div>
          <div style="font-size:.65rem; letter-spacing:1px; color:var(--muted); text-transform:uppercase;">Final Œº</div>
        </div>
        <div style="text-align:center">
          <div style="font-family:'Bebas Neue',sans-serif; font-size:1.4rem; color:var(--green)">{{ s.accuracy_pct }}%</div>
          <div style="font-size:.65rem; letter-spacing:1px; color:var(--muted); text-transform:uppercase;">Acc</div>
        </div>
        <div style="text-align:center">
          <div style="font-family:'Bebas Neue',sans-serif; font-size:1.4rem;">üî•{{ s.best_streak }}</div>
          <div style="font-size:.65rem; letter-spacing:1px; color:var(--muted); text-transform:uppercase;">Streak</div>
        </div>
        <span class="tag">{{ s.mode }}</span>
      </div>
    </div>
    {% endfor %}
  {% else %}
    <div class="empty">No games played yet. <a href="/" style="color:var(--gold)">Play your first game!</a></div>
  {% endif %}
</div>
</body>
</html>